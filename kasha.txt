каша из топора с ошибками
1. Не выделено, где какой вид алгоритма использовался.

2. В отдельных моментах потерялась логика про "попробовать" - сейчас получается мы добавляем ингредиенты подряд, без какой либо промежуточной оценки (а в тексте она есть).